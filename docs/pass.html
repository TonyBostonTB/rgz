<!DOCTYPE html><html lang="en">
<head><title>Command line password manager powered by LibreSSL - Roman Zolotarev</title><meta charset="utf-8"><meta name="referrer" content="no-referrer"><link rel="stylesheet" href="/styles.css"><link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#ffffff"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
</head>
<body><script>!function(t){ t.addEventListener('DOMContentLoaded', function () { var l = t.querySelector('#light-off'); if (l === null) { console.log('Lights-out...'); } else { l.checked = t.cookie.match(/lightOff=true/) !== null; l.addEventListener('change', function () { t.cookie = 'lightOff=' + JSON.stringify(l.checked) + ';path=/'; }); } })}(document);</script><input class="light-off" type="checkbox" id="light-off">
<div class="page">
<div class="header"><div class="header__home"><a href="/">Home</a> - <a href="https://twitter.com/romanzolotarev">Twitter</a></div><div class="header__light-off"><label for="light-off" class="light-off-button"></label></div></div>
<div class="article"><h1 id="Command%20line%20password%20manager%20powered%20by%20LibreSSL">Command line password manager powered by LibreSSL</h1>

<p><a href="/bin/pass">pass</a> is a POSIX-compliant shell script. It works on OpenBSD
and macOS out-of-the-box, because it depends only on the software in the
base (for example: sh, openssl, tar, grep, cat).</p>

<p>Frankly, it has one 3rd-party dependency, if you need time-based one-time
passwords. If that is the case you need to install
<a href="http://www.nongnu.org/oath-toolkit/oathtool.1.html">oathtool(1)</a>.</p>

<pre><code># pkg_add oath-toolkit
</code></pre>

<p>Download and run <code>pass</code>. Assuming <code>./bin</code> is in <code>PATH</code>.</p>

<pre><code>$ cd bin
$ ftp https://www.romanzolotarev.com/bin/pass
$ chmod +x pass
$ pass
usage: export BASE_DIR=~/.pass
       export PRIVATE_KEY=~/.pass/.key
       export PUBLIC_KEY=~/.pass/.key.pub

       pass init
          | passphrase
          | add        id
          | import     id &lt;pass&gt;
          | show       id
          | export     id &lt;pass&gt;
          | ls        &lt;id&gt;
</code></pre>

<h2 id="Initialization">Initialization</h2>

<p>Create a directory for your passwords and generate your key pair.
Please pick <a href="/diceware.html">a strong master pass phrase</a> for your keys.</p>

<pre><code>$ pass init
Generating public/private key pair.
New pass phrase:
Confirm:
Generating RSA private key, 2048 bit long modulus
..........................+++
..................+++
e is 65537 (0x10001)
writing RSA key
$ ls -1 ~/.pass
.key
.key.pub
$
</code></pre>

<p>Yep, as result you will get two files in <code>~/.pass</code> directory. These files are
your keys and they are protected with your master passphrase.</p>

<hr/>

<p><strong>Important!</strong> Backup these files, you won&#8217;t be able to recover any of
your passwords without the private key. Also make sure you remember your
pass phrase, there is no way to recover it either.</p>

<hr/>

<h2 id="Change%20pass%20phrase">Change pass phrase</h2>

<p>You can always change the master pass phrase for your private key.</p>

<pre><code>$ pass passphrase
Changing /home/romanzolotarev/.pass/.key pass phrase.
Current pass phrase:
New pass phrase:
Confirm:
Pass phrase changed.
$
</code></pre>

<h2 id="Add%20a%20password">Add a password</h2>

<p>Ready for the next step? Let&#8217;s add your first password. Run the following
command and enter your master pass phrase, then type-in the password and
hit Enter. In the second line type username and in the third line type
url. Press Enter and CTRL-D to save the password.</p>

<pre><code>$ pass add github
Pass phrase:
Press Enter and CTRL-D to complete.
always mule boots jaguar agnostic singles dalmatian vixen
username: romanzolotarev
url: https://github.com
$
</code></pre>

<h2 id="Import%20a%20password">Import a password</h2>

<p>Instead of typing your passwords manually you can pipe <a href="/diceware.html">your favorite password
generator</a> right into <code>pass</code>.</p>

<pre><code>$ diceware | pass import twitter
Enter pass phrase for /home/romanzolotarev/.pass/.key:
$
</code></pre>

<h2 id="Edit%20the%20password">Edit the password</h2>

<p>If you want to update your password run:</p>

<pre><code>$ pass edit github
Enter pass phrase for /home/romanzolotarev/.pass/.key:
</code></pre>

<p>As soon as you enter the pass phrase <code>pass</code> opens <code>vi</code> with the content of
your password file. Let&#8217;s enable <a href="https://help.github.com/articles/providing-your-2fa-authentication-code/">2FA at
GitHub</a>
paste the TOTP seed from GitHub into the password file. For example:</p>

<pre><code>totp: fx33dwhsbw7esrda
</code></pre>

<p>When you&#8217;re done press <code>ZZ</code> to save and exit <code>vi</code>.</p>

<h2 id="Show%20the%20password">Show the password</h2>

<p>To show a password you can run:</p>

<pre><code>$ pass show twitter
pelican mule satchel headband yo-yo lemon luscious older
$
</code></pre>

<p>But if a password file has a line staring with <code>totp:</code>, then <code>pass</code> shows
one time password in the second line.</p>

<pre><code>$ pass show github
Enter pass phrase for /home/romanzolotarev/.pass/.key:
always mule boots jaguar agnostic singles dalmatian vixen
122635
$
</code></pre>

<h2 id="Export%20the%20password">Export the password</h2>

<p>If you want to see all lines of your password file, you can use <code>export</code></p>

<pre><code>$ pass export github
always mule boots jaguar agnostic singles dalmatian vixen
username: romanzolotarev
url: https://github.com
$
</code></pre>

<h2 id="List%20all%20passwords">List all passwords</h2>

<p>To list all your passwords run:</p>

<pre><code>$ pass ls
github
twitter
$
</code></pre>

<h2 id="Files">Files</h2>

<pre><code>.pass
|-- .key           - RSA private key protected by pass phrase
|-- .key.pub       - RSA public key
|-- github         - tar archive of two files:
|   |-- github.key - AES key encrypted with RSA public key
|   `-- github.enc - text file encrypted with AES key
|-- github.sig     - signature of tar archive created with
|                    RSA private key
</code></pre>

<p>Every time you change your password file <code>pass</code> generates tar archive with
a new AES key and a new signature. <code>pass</code> verifies the signature every
time you show or export the password.</p>

<h2 id="Environment%20variables">Environment variables</h2>

<p>To change path to the working directory or your keys, define
environment variables <code>BASE_DIR</code>, <code>PRIVATE_KEY</code>, <code>PUBLIC_KEY</code>. For example:</p>

<pre><code>$ BASE_DIR=~/.pass \
PRIVATE_KEY=~/.pass/.key \
PUBLIC_KEY=~/.pass/.key.pub pass init
...
</code></pre></div>
<div class="footer">&copy; <a href="/">Roman Zolotarev</a></div>
</div></body></html>
