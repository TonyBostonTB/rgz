<!DOCTYPE html><html lang="en">
<head><title>Backup with borg - Roman Zolotarev</title><meta charset="utf-8"><meta name="referrer" content="no-referrer"><link rel="stylesheet" href="/styles.css"><link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#ffffff"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
</head>
<body><script>!function(t){ t.addEventListener('DOMContentLoaded', function () { var l = t.querySelector('#light-off'); if (l === null) { console.log('Lights-out...'); } else { l.checked = t.cookie.match(/lightOff=true/) !== null; l.addEventListener('change', function () { t.cookie = 'lightOff=' + JSON.stringify(l.checked) + ';path=/'; }); } })}(document);</script><input class="light-off" type="checkbox" id="light-off">
<div class="page">
<div class="header"><div class="header__home"><a href="/">Home</a> - <a href="https://twitter.com/romanzolotarev">Twitter</a></div><div class="header__light-off"><label for="light-off" class="light-off-button"></label></div></div>
<div class="article"><h1 id="Backup%20with%20borg">Backup with borg</h1>

<p>Install <a href="https://www.borgbackup.org/">BorgBackup</a>:</p>

<pre><code># pkg_add borgbackup-1.0.11
</code></pre>

<p>Initialize the repository:</p>

<pre><code>$ borg init -v &#39;~/backups&#39;
</code></pre>

<p>Create the first archive:</p>

<pre><code>$ borg create --list -p -s -v &quot;~/backups::$(date +%Y%m%d-%H%M)&quot;
</code></pre>

<p>To automate your backups let&#8217;s create a little shell script:</p>

<pre><code>#!/bin/sh
export BORG_REPO=&#39;USERNAME@SERVER.rsync.net:REPO&#39;
export BORG_REMOTE_PATH=&#39;/usr/local/bin/borg1/borg1&#39;
export BORG_RSH=&quot;ssh -i $HOME/.ssh/key&quot;
export BORG_PASSPHRASE=&#39;hoinaset&#39;
archive=$(date +%Y%m%d-%H%M)
borg create -C lzma,9 -p -s &quot;::$archive&quot; &quot;$HOME&quot;

borg prune -v --list --stats\
  --keep-hourly 48\
  --keep-daily 60\
  --keep-monthly 12\
  --keep-yearly 10\
  &#39;::&#39;
</code></pre>

<p>To check repository:</p>

<pre><code>$ borg check -v &#39;::&#39;
</code></pre>

<p>To extract</p>

<pre><code>$ borg extract -v --list &#39;::&#39; home/romanzolotarev/.vim/vimrc
</code></pre>

<h2 id="Removable%20storage">Removable storage</h2>

<pre><code># mkdir -p &quot;/mnt/$drive&quot;
# mount &quot;/dev/$drive&quot; &quot;/mnt/$drive&quot;
# umount &quot;/dev/$drive&quot;
</code></pre>

<h2 id="Remote%20storage">Remote storage</h2>

<p>You can setup your own server or use something like
<a href="http://www.rsync.net/products/attic.html">Rsync.net</a> account ($9/year for
25 GB or $0.36/year/GB).</p></div>
<div class="footer">&copy; <a href="/">Roman Zolotarev</a></div>
</div></body></html>
