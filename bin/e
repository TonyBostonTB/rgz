#!/bin/sh
[ -f "$1" ] || { >&2 echo "usage: ${0##*/} <existing_script>"; exit 1; }
[ -x "$(which entr)" ] || exit 2
[ -x "$(which shellcheck)" ] || exit 3

set -e

script="$1" 
test="$1_test"

cmd1="vi $script"
cmd2="find $script $test | entr -c sh -c 'shellcheck '$script' && echo \"$script\" && \"$test\"'"
tmux new-window -n "$script" "$cmd1"
tmux split-window -dh "$cmd2"
